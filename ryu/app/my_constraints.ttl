@prefix : <http://home.eps.hw.ac.uk/~qz1/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .

:Switch a owl:Class ;
	rdfs:subClassOf
        [ owl:onProperty :hasPort	   ; owl:minCardinality 0 ] ,
        [ owl:onProperty :hasHost	   ; owl:minCardinality 0 ] ,
        [ owl:onProperty :hasName	   ; owl:minCardinality 1 ] ,
        [ owl:onProperty :hasName	   ; owl:maxCardinality 1 ] ,
        [ owl:onProperty :hasID	   ; owl:minCardinality 1 ] ,
        [ owl:onProperty :hasID	   ; owl:maxCardinality 1 ]  .
:hasName a owl:ObjectProperty ; rdfs:domain :Switch .
:hasID   a owl:ObjectProperty ; rdfs:domain :Switch .
:hasHost a owl:ObjectProperty ; rdfs:domain :Switch; rdfs:range :Host .
:hasFlow a owl:ObjectProperty ; rdfs:domain :Switch ; rdfs:range :Flow .

:Port a owl:Class ;
    rdfs:subClassOf
        [ owl:onProperty :isIn  	   ; owl:minCardinality 1 ] ,
        [ owl:onProperty :isIn  	   ; owl:maxCardinality 1 ] ,
        [ owl:onProperty :hasName	   ; owl:minCardinality 1 ] ,
        [ owl:onProperty :hasName      ; owl:maxCardinality 1 ] ,
        [ owl:onProperty :hasMAC	   ; owl:minCardinality 1 ] ,
        [ owl:onProperty :hasMAC       ; owl:maxCardinality 1 ] ,
        [ owl:onProperty :port_no	   ; owl:minCardinality 1 ] ,
        [ owl:onProperty :port_no      ; owl:maxCardinality 1 ] ,
        [ owl:onProperty :isUp  	   ; owl:minCardinality 1 ] ,
        [ owl:onProperty :isUp         ; owl:maxCardinality 1 ] .
:isIn    a owl:ObjectProperty ; rdfs:domain :Port; rdfs:range :Switch.
:hasName a owl:ObjectProperty ; rdfs:domain :Port.
:hasMAC  a owl:ObjectProperty ; rdfs:domain :Port ; rdfs:domain :Host.
:port_no a owl:ObjectProperty ; rdfs:domain :Port.
:isUp    a owl:ObjectProperty ; rdfs:domain :Port.

# TODO The host must have port with a MAC and connecting to a single switch port for each port
:Host a owl:Class ;
    rdfs:subClassOf
        [ owl:onProperty :connectToPort	   ; owl:minCardinality 1 ] ,
        [ owl:onProperty :hasMAC	       ; owl:minCardinality 1 ] ,
        [ owl:onProperty :hasIPv4	       ; owl:minCardinality 1 ] .
:hasIPv4       a owl:ObjectProperty ; rdfs:domain :Host.
:connectToPort a owl:ObjectProperty ; 
    rdfs:domain :Host; 
    rdfs:domain :Port; 
    rdfs:domain :Link; 
    rdfs:range :Port; 
    rdfs:range :Host.

:Link a owl:Class ;
    rdfs:subClassOf
        [ owl:onProperty :connectToPort	   ; owl:minCardinality 2 ] ,
        [ owl:onProperty :connectToPort	   ; owl:maxCardinality 2 ].

:Flow a owl:Class ;
	rdfs:subClassOf
        [ owl:onProperty :hasInPort	   ; owl:minCardinality 1 ] ,
        [ owl:onProperty :hasInPort	   ; owl:maxCardinality 1 ] ,
        [ owl:onProperty :hasDstAddr   ; owl:minCardinality 1 ] ,
        [ owl:onProperty :hasDstAddr   ; owl:maxCardinality 1 ] ,
        [ owl:onProperty :hasAction    ; owl:minCardinality 1 ] ,
        [ owl:onProperty :hasAction    ; owl:maxCardinality 1 ] .
:hard_timeout  a owl:ObjectProperty; rdfs:domain :Flow.
:idle_timeout  a owl:ObjectProperty; rdfs:domain :Flow.
:flags         a owl:ObjectProperty; rdfs:domain :Flow.
:table_id      a owl:ObjectProperty; rdfs:domain :Flow.
:cookie        a owl:ObjectProperty; rdfs:domain :Flow.
:in_port        a owl:ObjectProperty; rdfs:domain :Flow. 
:in_phy_port    a owl:ObjectProperty; rdfs:domain :Flow. 
:metadata       a owl:ObjectProperty; rdfs:domain :Flow. 
:eth_dst        a owl:ObjectProperty; rdfs:domain :Flow. 
:eth_src        a owl:ObjectProperty; rdfs:domain :Flow. 
:eth_type       a owl:ObjectProperty; rdfs:domain :Flow. 
:vlan_vid       a owl:ObjectProperty; rdfs:domain :Flow. 
:vlan_pcp       a owl:ObjectProperty; rdfs:domain :Flow. 
:ip_dscp        a owl:ObjectProperty; rdfs:domain :Flow. 
:ip_ecn         a owl:ObjectProperty; rdfs:domain :Flow. 
:ip_proto       a owl:ObjectProperty; rdfs:domain :Flow. 
:ipv4_src       a owl:ObjectProperty; rdfs:domain :Flow. 
:ipv4_dst       a owl:ObjectProperty; rdfs:domain :Flow. 
:tcp_src        a owl:ObjectProperty; rdfs:domain :Flow. 
:tcp_dst        a owl:ObjectProperty; rdfs:domain :Flow. 
:udp_src        a owl:ObjectProperty; rdfs:domain :Flow. 
:udp_dst        a owl:ObjectProperty; rdfs:domain :Flow. 
:sctp_src       a owl:ObjectProperty; rdfs:domain :Flow. 
:sctp_dst       a owl:ObjectProperty; rdfs:domain :Flow. 
:icmpv4_type    a owl:ObjectProperty; rdfs:domain :Flow. 
:icmpv4_code    a owl:ObjectProperty; rdfs:domain :Flow. 
:arp_op         a owl:ObjectProperty; rdfs:domain :Flow. 
:arp_spa        a owl:ObjectProperty; rdfs:domain :Flow. 
:arp_tpa        a owl:ObjectProperty; rdfs:domain :Flow. 
:arp_sha        a owl:ObjectProperty; rdfs:domain :Flow. 
:arp_tha        a owl:ObjectProperty; rdfs:domain :Flow. 
:ipv6_src       a owl:ObjectProperty; rdfs:domain :Flow. 
:ipv6_dst       a owl:ObjectProperty; rdfs:domain :Flow. 
:ipv6_flabel    a owl:ObjectProperty; rdfs:domain :Flow. 
:icmpv6_type    a owl:ObjectProperty; rdfs:domain :Flow. 
:icmpv6_code    a owl:ObjectProperty; rdfs:domain :Flow. 
:ipv6_nd_target a owl:ObjectProperty; rdfs:domain :Flow.
:ipv6_nd_sll    a owl:ObjectProperty; rdfs:domain :Flow.
:ipv6_nd_tll    a owl:ObjectProperty; rdfs:domain :Flow.
:mpls_label     a owl:ObjectProperty; rdfs:domain :Flow.
:mpls_tc        a owl:ObjectProperty; rdfs:domain :Flow.
:mpls_bos       a owl:ObjectProperty; rdfs:domain :Flow.
:pbb_isid       a owl:ObjectProperty; rdfs:domain :Flow.
:tunnel_id      a owl:ObjectProperty; rdfs:domain :Flow.
:ipv6_exthdr    a owl:ObjectProperty; rdfs:domain :Flow.
:pbb_uca        a owl:ObjectProperty; rdfs:domain :Flow.
:tcp_flags      a owl:ObjectProperty; rdfs:domain :Flow.
:hasAction     a owl:ObjectProperty; rdfs:domain :Flow.

:Action a owl:Class.
:hasType a owl:DatatypeProperty ; rdfs:domain :Action .			# Action
:toPort a owl:DatatypeProperty ; rdfs:domain :Action; rdfs:range :Port.

:Path a owl:Class.
:src_path a owl:ObejctProperty; rdfs:domain :Path; rdfs:range :Host.
:dst_path a owl:ObejctProperty; rdfs:domain :Path; rdfs:range :Host.

:PathFlow rdfs:SubClassOf :Flow.
:hopCount a owl:ObjectProperty; rdfs:domain :PathFlow.
:path a owl:ObjectProperty; rdfs:domain :PathFlow; rdfs:range :Path.

